==== Indexeur ====
Avant de commencer à réaliser un indexeur, il faut savoir où se trouve les fichiers de la banque. Pour connaitre l'emplacement de vos fichiers, la commande pwd (//Print Working Directory//) permet d'afficher le chemin du dossier dans lequel on se trouve.

Ce code ci-dessous fonctionne avec le format d'entrée de la banque de données **GenBank**. 
<file python indexeur> 

#~ c'est la meme chose que sed et grep mais avec python
 
import sys
import gzip
fn=sys.argv[1]
f=gzip.open(fn)


#~ le probleme est qu'il y a du texte avant le 1er 
#~ locus donc nous devons dire que le premier LOCUS est plus loin que le debut du fichier:
l=''
while not l.startswith("LOCUS"):
	beg=f.tell()
	l=f.readline()
f.seek(beg)
#~ Tant que la ligne ne commence pas par locus, beg 
#~ prendra des valeurs qui correspont au texte avant locus

	
for l in f:
	if l.startswith("LOCUS"):
		id=l.split()[1]
		
	if l.startswith("//"):
		offset=f.tell()
		print id,beg,offset-beg,fn
		beg=offset
#~Si la phrase commence par locus id prendra la valeur 
#~ de la 2eme position du split c a d l'identifiant 
 
#~ si la phrase commence par // alors on demande sa position et
#~ deviendra le nouveau beg pour le LOCUS suivant 


</file>

Ce code ne fonctionne que pour un seul fichier. Afin de l'appliquer à plusieurs fichiers dans un même dossier, une simple commande shell permet de répéter l'opération sur tout les fichiers.
<code bash>
for f in /"chemin_des_fichiers"/fichier*.gz; do python2 /"chemin_de_l'indexeur"/indexeur $f >> index ; done
</code>
Pour tout les fichiers le programme indexeur est éxecuté et son résultat est écrit dans un fichier index.

^ID ^Offset ^longueur ^fichier^
^AB000100 ^263 ^7465 ^/data/dbs/gbrel/gbbct1.seq.gz^
^AB000106 ^7728 ^2913 ^/data/dbs/gbrel/gbbct1.seq.gz^
^AB000111 ^10641 ^35603 ^/data/dbs/gbrel/gbbct1.seq.gz^


Toutes ces informations sont utilisés par un autre programme qui permet de chercher une séquence par son code d'accés et d'afficher son entrée dans la banque.
Le premier argument correspond au code d'accés de la séquence recherché, le second argument correspond à l'écart entre le début du fichier et le début de l'entrée, le troisième argument correspond le nombre de caractères à lire par le programme et le dernier correspond au fichier dans lequel se trouve l'entrée.

Il existe d'autres manières de faire des index. Par exemple, certaines commandes du bash sed et grep utilisant des expressions régulières permettent d'obtenir le même résulat.

L'avantage d'un programme en python, c'est que celui peut se placer à une position de caractère précise et de lire un nombre de caractères voulu. Contrairement au sed qui lui doit lire tout le fichier avant de retourner un résultat. 

=== Programme de recherche d'une séquence ===

Voici un programme qui récupère les arguments ci-dessus.
<file python rechercheur de sequence >
#!/usr/bin/python2
#~ la ligne de dessus sert le rendre executable par le shell

import sys 
import gzip
fn=sys.argv[1]

index="/data/indexes/indexpython.gz"

f=gzip.open(index)
l=''
while not l.startswith(fn):
	l=f.readline()

l=l.split()
offset=int(l[1])
nbroct=int(l[2])
ch=l[3]

f=gzip.open(ch)
p=f.seek(offset)
r=f.read(nbroct)
print r.strip() 
#~ retire le retour a la ligne 

</file>