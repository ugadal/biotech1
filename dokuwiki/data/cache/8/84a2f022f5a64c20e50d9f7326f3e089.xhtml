
<p>
taken from 
<a href="http://en.gentoo-wiki.com/wiki/Initramfs" class="urlextern" title="http://en.gentoo-wiki.com/wiki/Initramfs"  rel="nofollow">http://en.gentoo-wiki.com/wiki/Initramfs</a>
</p>
<pre class="code">#Create a work directory.
mkdir /usr/src/initramfs
cd /usr/src/initramfs

# Create basic directories for initramfs.
mkdir -p bin lib dev etc mnt/root proc root sbin sys

# Copy devices required for booting.
cp -a /dev/{null,console,tty,md0,sd*} /usr/src/initramfs/dev/

# mdadm needs to be built as static, so that we don&#039;t need to
# bother with required libraries.
USE=&quot;static&quot; emerge -v mdadm
cp -a /sbin/mdadm /usr/src/initramfs/bin/

# Create &quot;init&quot; file.
/usr/src/initramfs/init
   #!/bin/busybox sh
   mount -t proc none /proc
   mount -t sysfs none /sys

   # I named mine as &quot;gentoo:0&quot;. Yours might be different.
   mdadm --assemble --scan /dev/md/gentoo:0
   # OR just &quot;mdadm --assemble /dev/md0 /dev/sd[abc]1&quot;

   mount -o ro /dev/md0 /mnt/root
   umount /proc
   umount /sys
   exec switch_root /mnt/root /sbin/init

chmod +x /usr/src/initramfs/init

# Generate initramfs file.
cd /usr/src/initramfs
find . -print0 | cpio --null -ov --format=newc | gzip -9 &gt; /boot/initramfs-2.6.39-gentoo-r3.img

# This is optional if you explicitly assemble /dev/md0.
# But it&#039;s always a good idea to make things flexible.
mdadm --detail --scan &gt;&gt; /etc/mdadm.conf
cp -a /etc/mdadm.conf /usr/src/initramfs/etc/</pre>
